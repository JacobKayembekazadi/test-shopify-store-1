{%- liquid
  assign selected_variant = product.selected_or_first_available_variant
-%}

<div class="product-page" data-section-id="{{ section.id }}" data-section-type="product" data-product-handle="{{ product.handle }}" data-product-id="{{ product.id }}">
  <!-- Shipping Banner (Optional) -->
  {%- if section.settings.show_shipping_banner and section.settings.shipping_banner_text != blank -%}
    <div class="product-page__shipping-banner">
      <div class="container">
        <p class="product-page__shipping-banner-text">{{ section.settings.shipping_banner_text }}</p>
      </div>
    </div>
  {%- endif -%}

  <div class="container">
    <!-- Breadcrumbs -->
    {%- if section.settings.show_breadcrumbs -%}
      <nav class="product-page__breadcrumbs" aria-label="Breadcrumb">
        <ol class="product-page__breadcrumbs-list">
          <li class="product-page__breadcrumbs-item">
            <a href="{{ routes.root_url }}" class="product-page__breadcrumbs-link">Home</a>
          </li>
          {%- if collection -%}
            <li class="product-page__breadcrumbs-item">
              <span class="product-page__breadcrumbs-separator">/</span>
              <a href="{{ collection.url }}" class="product-page__breadcrumbs-link">{{ collection.title }}</a>
            </li>
          {%- endif -%}
          <li class="product-page__breadcrumbs-item">
            <span class="product-page__breadcrumbs-separator">/</span>
            <span class="product-page__breadcrumbs-current">{{ product.title }}</span>
          </li>
        </ol>
      </nav>
    {%- endif -%}

    <div class="product-page__wrapper {% if section.settings.media_position == 'right' %}product-page__wrapper--reverse{% endif %}">
      <!-- Product Media Gallery -->
      <div class="product-page__media {% if section.settings.enable_sticky_info and section.settings.media_position != 'right' %}product-page__media--sticky{% endif %}">
        {%- if product.media.size > 0 -%}
          <div class="product-page__gallery" data-media-gallery>
            <!-- Thumbnails (Vertical Layout - Left Side) -->
            {%- if section.settings.gallery_layout == 'thumbnails-left' and product.media.size > 1 -%}
              <div class="product-page__thumbnails product-page__thumbnails--vertical {% if section.settings.mobile_thumbnails == 'hide' %}product-page__thumbnails--desktop-only{% endif %}" data-media-thumbnails>
                {%- for media in product.media -%}
                  <button
                    type="button"
                    class="product-page__thumbnail {% if forloop.first %}product-page__thumbnail--active{% endif %}"
                    data-media-id="{{ media.id }}"
                    data-media-type="{{ media.media_type }}"
                    aria-label="View {{ media.alt | default: 'media' }} {{ forloop.index }}"
                    aria-current="{% if forloop.first %}true{% else %}false{% endif %}"
                  >
                    {%- if media.media_type == 'video' or media.media_type == 'external_video' -%}
                      <div class="product-page__thumbnail-icon">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
                          <path d="M6 4l6 4-6 4V4z" fill="currentColor"/>
                        </svg>
                      </div>
                    {%- elsif media.media_type == 'model' -%}
                      <div class="product-page__thumbnail-icon">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
                          <path d="M8 2L2 6v4l6 4 6-4V6L8 2z" fill="currentColor"/>
                        </svg>
                      </div>
                    {%- endif -%}
                    <img
                      src="{{ media | image_url: width: 120 }}"
                      alt="{{ media.alt | escape }}"
                      width="120"
                      height="120"
                      loading="lazy"
                    >
                  </button>
                {%- endfor -%}
              </div>
            {%- endif -%}

            <!-- Main Media Display -->
            <div class="product-page__main-image">
              {%- for media in product.media -%}
                <div class="product-page__media-item {% if forloop.first %}product-page__media-item--active{% endif %}" data-media-id="{{ media.id }}" data-media-type="{{ media.media_type }}">
                  {%- case media.media_type -%}
                    {%- when 'image' -%}
                      {%- if section.settings.image_zoom == 'lightbox' -%}
                        <a href="{{ media | image_url: width: 2048 }}" class="product-page__media-link" data-lightbox>
                          <img
                            src="{{ media | image_url: width: 1200 }}"
                            srcset="{{ media | image_url: width: 600 }} 600w,
                                    {{ media | image_url: width: 900 }} 900w,
                                    {{ media | image_url: width: 1200 }} 1200w,
                                    {{ media | image_url: width: 1800 }} 1800w"
                            sizes="(min-width: 990px) 50vw, 100vw"
                            alt="{{ media.alt | escape }}"
                            class="product-page__image"
                            width="{{ media.width }}"
                            height="{{ media.height }}"
                            loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                          >
                        </a>
                      {%- else -%}
                        <img
                          src="{{ media | image_url: width: 1200 }}"
                          srcset="{{ media | image_url: width: 600 }} 600w,
                                  {{ media | image_url: width: 900 }} 900w,
                                  {{ media | image_url: width: 1200 }} 1200w,
                                  {{ media | image_url: width: 1800 }} 1800w"
                          sizes="(min-width: 990px) 50vw, 100vw"
                          alt="{{ media.alt | escape }}"
                          class="product-page__image"
                          width="{{ media.width }}"
                          height="{{ media.height }}"
                          loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                        >
                      {%- endif -%}
                    {%- when 'video' -%}
                      <div class="product-page__video">
                        {{ media | video_tag: image_size: "1200x", loop: section.settings.enable_video_looping, controls: true, preload: "none", autoplay: false }}
                      </div>
                    {%- when 'external_video' -%}
                      <div class="product-page__external-video">
                        {%- assign video_class = 'js-' | append: media.host -%}
                        {%- if media.host == 'youtube' -%}
                          {{ media | external_video_tag: class: video_class, loading: "lazy", loop: section.settings.enable_video_looping, playlist: media.external_id }}
                        {%- elsif media.host == 'vimeo' -%}
                          {{ media | external_video_tag: class: video_class, loading: "lazy", loop: section.settings.enable_video_looping }}
                        {%- endif -%}
                      </div>
                    {%- when 'model' -%}
                      <div class="product-page__model">
                        {{ media | model_viewer_tag: image_size: "1200x", toggleable: true, data-model-id: media.id, reveal: "interaction" }}
                      </div>
                  {%- endcase -%}
                </div>
              {%- endfor -%}
            </div>

            <!-- Thumbnails (Horizontal Layout - Below Main Image) -->
            {%- if section.settings.gallery_layout == 'thumbnails-bottom' and product.media.size > 1 -%}
              <div class="product-page__thumbnails product-page__thumbnails--horizontal {% if section.settings.mobile_thumbnails == 'hide' %}product-page__thumbnails--desktop-only{% endif %}" data-media-thumbnails>
                {%- for media in product.media -%}
                  <button
                    type="button"
                    class="product-page__thumbnail {% if forloop.first %}product-page__thumbnail--active{% endif %}"
                    data-media-id="{{ media.id }}"
                    data-media-type="{{ media.media_type }}"
                    aria-label="View {{ media.alt | default: 'media' }} {{ forloop.index }}"
                    aria-current="{% if forloop.first %}true{% else %}false{% endif %}"
                  >
                    {%- if media.media_type == 'video' or media.media_type == 'external_video' -%}
                      <div class="product-page__thumbnail-icon">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
                          <path d="M6 4l6 4-6 4V4z" fill="currentColor"/>
                        </svg>
                      </div>
                    {%- elsif media.media_type == 'model' -%}
                      <div class="product-page__thumbnail-icon">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
                          <path d="M8 2L2 6v4l6 4 6-4V6L8 2z" fill="currentColor"/>
                        </svg>
                      </div>
                    {%- endif -%}
                    <img
                      src="{{ media | image_url: width: 120 }}"
                      alt="{{ media.alt | escape }}"
                      width="120"
                      height="120"
                      loading="lazy"
                    >
                  </button>
                {%- endfor -%}
              </div>
            {%- endif -%}
          </div>
        {%- else -%}
          <div class="product-page__placeholder">
            {{ 'product-1' | placeholder_svg_tag: 'product-page__placeholder-svg' }}
          </div>
        {%- endif -%}
      </div>

      <!-- Product Info -->
      <div class="product-page__info {% if section.settings.enable_sticky_info and section.settings.media_position == 'right' %}product-page__info--sticky{% endif %}">
        <!-- Vendor -->
        {%- if section.settings.show_vendor and product.vendor != blank -%}
          <p class="product-page__vendor">
            <a href="{{ product.vendor | url_for_vendor }}" class="product-page__vendor-link">{{ product.vendor }}</a>
          </p>
        {%- endif -%}

        <!-- Title -->
        <h1 class="product-page__title">{{ product.title }}</h1>

        <!-- Reviews/Ratings -->
        {%- if section.settings.show_reviews -%}
          <div class="product-page__reviews">
            {%- if section.settings.reviews_rating != blank -%}
              <div class="product-page__rating">
                {%- assign rating = section.settings.reviews_rating | times: 1.0 -%}
                {%- for i in (1..5) -%}
                  <svg class="product-page__star {% if i <= rating %}product-page__star--filled{% endif %}" width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="{% if i <= rating %}currentColor{% else %}none{% endif %}" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                {%- endfor -%}
              </div>
            {%- endif -%}
            {%- if section.settings.reviews_count != blank -%}
              <span class="product-page__reviews-count">{{ section.settings.reviews_count }} reviews</span>
            {%- endif -%}
            {%- if section.settings.reviews_link != blank -%}
              <a href="{{ section.settings.reviews_link }}" class="product-page__reviews-link">Read reviews</a>
            {%- endif -%}
          </div>
        {%- endif -%}

        <!-- Price -->
        <div class="product-page__price-wrapper" data-price-wrapper>
          <span class="product-page__price" data-price>
            {{ selected_variant.price | money }}
          </span>
          {%- if selected_variant.compare_at_price > selected_variant.price -%}
            <span class="product-page__compare-price" data-compare-price>
              {{ selected_variant.compare_at_price | money }}
            </span>
            {%- liquid
              assign discount_amount = selected_variant.compare_at_price | minus: selected_variant.price
              assign discount_percentage = discount_amount | times: 100.0 | divided_by: selected_variant.compare_at_price | round
            -%}
            <span class="product-page__discount-badge" data-discount-badge>
              Save {{ discount_percentage }}%
            </span>
          {%- endif -%}
        </div>

        <!-- Stock Message -->
        {%- if section.settings.show_stock_message -%}
          <div class="product-page__stock-message" data-stock-message style="display: none;">
            <span class="product-page__stock-text" data-stock-text></span>
          </div>
        {%- endif -%}

        <!-- Product Form -->
        {% render 'product-form', 
          product: product, 
          selected_variant: selected_variant,
          section: section
        %}

        <!-- Trust Badges -->
        {%- if section.settings.show_trust_badges -%}
          <div class="product-page__trust-badges">
            {%- if section.settings.trust_badge_1_text != blank -%}
              <div class="product-page__trust-badge">
                {%- if section.settings.trust_badge_1_icon != blank -%}
                  <img src="{{ section.settings.trust_badge_1_icon | image_url: width: 40 }}" alt="{{ section.settings.trust_badge_1_text }}" width="40" height="40">
                {%- endif -%}
                <span>{{ section.settings.trust_badge_1_text }}</span>
              </div>
            {%- endif -%}
            {%- if section.settings.trust_badge_2_text != blank -%}
              <div class="product-page__trust-badge">
                {%- if section.settings.trust_badge_2_icon != blank -%}
                  <img src="{{ section.settings.trust_badge_2_icon | image_url: width: 40 }}" alt="{{ section.settings.trust_badge_2_text }}" width="40" height="40">
                {%- endif -%}
                <span>{{ section.settings.trust_badge_2_text }}</span>
              </div>
            {%- endif -%}
            {%- if section.settings.trust_badge_3_text != blank -%}
              <div class="product-page__trust-badge">
                {%- if section.settings.trust_badge_3_icon != blank -%}
                  <img src="{{ section.settings.trust_badge_3_icon | image_url: width: 40 }}" alt="{{ section.settings.trust_badge_3_text }}" width="40" height="40">
                {%- endif -%}
                <span>{{ section.settings.trust_badge_3_text }}</span>
              </div>
            {%- endif -%}
          </div>
        {%- endif -%}

        <!-- Tax/Shipping Text -->
        {%- if section.settings.show_tax_shipping_text and section.settings.tax_shipping_text != blank -%}
          <p class="product-page__tax-shipping-text">{{ section.settings.tax_shipping_text }}</p>
        {%- endif -%}

        <!-- Benefits/Bullet Points -->
        {%- if section.settings.show_benefits -%}
          <div class="product-page__benefits">
            {%- if section.settings.benefit_1 != blank -%}
              <div class="product-page__benefit-item">
                <svg class="product-page__benefit-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M16.667 5L7.5 14.167 3.333 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>{{ section.settings.benefit_1 }}</span>
              </div>
            {%- endif -%}
            {%- if section.settings.benefit_2 != blank -%}
              <div class="product-page__benefit-item">
                <svg class="product-page__benefit-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M16.667 5L7.5 14.167 3.333 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>{{ section.settings.benefit_2 }}</span>
              </div>
            {%- endif -%}
            {%- if section.settings.benefit_3 != blank -%}
              <div class="product-page__benefit-item">
                <svg class="product-page__benefit-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M16.667 5L7.5 14.167 3.333 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>{{ section.settings.benefit_3 }}</span>
              </div>
            {%- endif -%}
            {%- if section.settings.benefit_4 != blank -%}
              <div class="product-page__benefit-item">
                <svg class="product-page__benefit-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M16.667 5L7.5 14.167 3.333 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>{{ section.settings.benefit_4 }}</span>
              </div>
            {%- endif -%}
          </div>
        {%- endif -%}

        <!-- Share Buttons -->
        {%- if section.settings.show_share_buttons -%}
          <div class="product-page__share">
            <span class="product-page__share-label">Share:</span>
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url | append: product.url }}" target="_blank" class="product-page__share-link" aria-label="Share on Facebook">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M18 10a8 8 0 10-9.25 7.9v-5.6H6.5v-2.3h2.25V8.65c0-2.22 1.32-3.45 3.35-3.45.97 0 1.98.17 1.98.17v2.18h-1.12c-1.1 0-1.44.68-1.44 1.38v1.67h2.5l-.4 2.3h-2.1v5.6A8 8 0 0018 10z"/>
              </svg>
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ shop.url | append: product.url }}&text={{ product.title | url_param_escape }}" target="_blank" class="product-page__share-link" aria-label="Share on Twitter">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M18.29 5.29a6.98 6.98 0 01-2.01.55 3.49 3.49 0 001.53-1.93 6.98 6.98 0 01-2.21.85 3.49 3.49 0 00-5.94 3.18 9.9 9.9 0 01-7.19-3.65 3.49 3.49 0 001.08 4.66 3.47 3.47 0 01-1.58-.44v.04a3.49 3.49 0 002.8 3.42 3.48 3.48 0 01-1.58.06 3.49 3.49 0 003.26 2.42 6.99 6.99 0 01-4.33 1.49c-.28 0-.56-.02-.84-.05a9.87 9.87 0 005.35 1.57c6.42 0 9.93-5.32 9.93-9.93 0-.15 0-.3-.01-.45a7.1 7.1 0 001.74-1.81z"/>
              </svg>
            </a>
            <a href="mailto:?subject={{ product.title | url_param_escape }}&body={{ shop.url | append: product.url | url_param_escape }}" class="product-page__share-link" aria-label="Share via Email">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 4h14v12H3V4z"/>
                <path d="M3 4l7 5 7-5"/>
              </svg>
            </a>
          </div>
        {%- endif -%}
      </div>
    </div>

    <!-- Product Description & Details -->
    <div class="product-page__details">
      <div class="product-page__details-grid">
        <!-- Description -->
        {%- if section.settings.show_description and product.description != blank -%}
          <div class="product-page__description-section">
            <h2 class="product-page__details-title">Product Details</h2>
            <div class="product-page__description">
              {{ product.description }}
            </div>
          </div>
        {%- endif -%}

        <!-- Product Info / Care Instructions -->
        {%- if section.settings.show_product_info and section.settings.product_info_content != blank -%}
          <div class="product-page__info-section">
            <h2 class="product-page__details-title">{{ section.settings.product_info_title | default: 'Product Info' }}</h2>
            <div class="product-page__info-content">
              {{ section.settings.product_info_content }}
            </div>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{%- render 'product-scripts', product: product, selected_variant: selected_variant, section: section -%}

<script>
  // Initialize stock message on page load
  document.addEventListener('DOMContentLoaded', function() {
    const productSection = document.querySelector('[data-section-id="{{ section.id }}"]');
    if (!productSection) return;
    
    const stockMessage = productSection.querySelector('.product-page__stock-message');
    const stockText = productSection.querySelector('.product-page__stock-text');
    const lowStockThreshold = {{ section.settings.low_stock_threshold | default: 5 }};
    
    {%- if selected_variant -%}
      const selectedVariant = {
        available: {{ selected_variant.available | json }},
        inventory_management: {{ selected_variant.inventory_management | json }},
        inventory_quantity: {{ selected_variant.inventory_quantity | json }}
      };

      if (stockMessage && stockText && selectedVariant) {
        if (!selectedVariant.available) {
          stockMessage.className = 'product-page__stock-message product-page__stock-message--out-of-stock';
          stockText.textContent = 'Out of stock';
          stockMessage.style.display = 'block';
        } else if (selectedVariant.inventory_management && selectedVariant.inventory_quantity <= lowStockThreshold && selectedVariant.inventory_quantity > 0) {
          stockMessage.className = 'product-page__stock-message product-page__stock-message--low-stock';
          stockText.textContent = `Only ${selectedVariant.inventory_quantity} left in stock`;
          stockMessage.style.display = 'block';
        } else if (selectedVariant.inventory_management && selectedVariant.inventory_quantity > lowStockThreshold) {
          stockMessage.className = 'product-page__stock-message product-page__stock-message--in-stock';
          stockText.textContent = 'In stock';
          stockMessage.style.display = 'block';
        }
      }
    {%- endif -%}
  });
</script>

<style>
  /* Product Page Container */
  .product-page {
    padding-top: 0;
    padding-bottom: 4rem;
    background-color: var(--color-bg-page);
  }

  @media screen and (min-width: 750px) {
    .product-page {
      padding-bottom: 6rem;
    }
  }

  /* Shipping Banner */
  .product-page__shipping-banner {
    background-color: var(--color-bg-section-soft);
    padding: 0.75rem 0;
    text-align: center;
    border-bottom: 1px solid var(--color-border-soft);
  }

  .product-page__shipping-banner-text {
    font-size: 0.875rem;
    color: var(--color-text-primary);
    margin: 0;
    font-weight: 500;
  }

  /* Breadcrumbs */
  .product-page__breadcrumbs {
    padding: 1.5rem 0 2rem;
  }

  .product-page__breadcrumbs-list {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 0;
    flex-wrap: wrap;
  }

  .product-page__breadcrumbs-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .product-page__breadcrumbs-link {
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .product-page__breadcrumbs-link:hover {
    color: var(--color-text-primary);
    text-decoration: underline;
  }

  .product-page__breadcrumbs-separator {
    color: var(--color-text-secondary);
  }

  .product-page__breadcrumbs-current {
    color: var(--color-text-primary);
    font-weight: 500;
  }

  /* Main Wrapper */
  .product-page__wrapper {
    display: grid;
    gap: 4rem;
    align-items: start;
    margin-bottom: 5rem;
  }

  @media screen and (min-width: 990px) {
    .product-page__wrapper {
      grid-template-columns: 1fr 1fr;
      gap: 5rem;
    }
  }

  .product-page__wrapper--reverse {
    direction: rtl;
  }

  .product-page__wrapper--reverse > * {
    direction: ltr;
  }

  /* Media Section */
  .product-page__media {
    position: relative;
  }

  .product-page__media--sticky {
    position: sticky;
    top: 2rem;
    align-self: start;
  }

  @media screen and (max-width: 989px) {
    .product-page__media--sticky {
      position: static;
      top: auto;
    }
  }

  /* Gallery */
  .product-page__gallery {
    display: flex;
    gap: 1rem;
    flex-direction: row;
  }

  @media screen and (max-width: 749px) {
    .product-page__gallery {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Thumbnails - Vertical (Left Side) */
  .product-page__thumbnails--vertical {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    flex-shrink: 0;
    width: 100px;
  }

  @media screen and (max-width: 749px) {
    .product-page__thumbnails--vertical {
      flex-direction: row;
      width: 100%;
      overflow-x: auto;
      padding-bottom: 0.5rem;
      scrollbar-width: thin;
    }

    .product-page__thumbnails--vertical.product-page__thumbnails--desktop-only {
      display: none;
    }
  }

  /* Thumbnails - Horizontal (Below) */
  .product-page__thumbnails--horizontal {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 0.75rem;
    margin-top: 1rem;
  }

  @media screen and (max-width: 749px) {
    .product-page__thumbnails--horizontal.product-page__thumbnails--desktop-only {
      display: none;
    }
  }

  .product-page__thumbnail {
    position: relative;
    aspect-ratio: 1;
    border: 2px solid transparent;
    border-radius: 0.5rem;
    overflow: hidden;
    cursor: pointer;
    padding: 0;
    background: none;
    transition: all 0.3s ease;
    flex-shrink: 0;
  }

  .product-page__thumbnail:hover,
  .product-page__thumbnail--active {
    border-color: var(--color-text-primary);
    transform: scale(1.05);
  }

  .product-page__thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .product-page__thumbnail-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 1.75rem;
    height: 1.75rem;
    background-color: rgba(0, 0, 0, 0.7);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    z-index: 1;
  }

  .product-page__thumbnail-icon svg {
    width: 12px;
    height: 12px;
  }

  /* Main Image */
  .product-page__main-image {
    position: relative;
    width: 100%;
    flex: 1;
    background-color: var(--color-bg-elevated);
    border-radius: 1rem;
    overflow: hidden;
    aspect-ratio: 1;
    min-height: 400px;
  }

  @media screen and (min-width: 750px) {
    .product-page__main-image {
      min-height: 500px;
    }
  }

  .product-page__media-item {
    display: none;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  .product-page__media-item--active {
    display: block;
  }

  .product-page__image {
    width: 100%;
    height: 100%;
    object-fit: {{ section.settings.media_fit }};
    display: block;
  }

  .product-page__media-link {
    display: block;
    width: 100%;
    height: 100%;
  }

  .product-page__video,
  .product-page__external-video,
  .product-page__model {
    width: 100%;
    height: 100%;
  }

  .product-page__video video,
  .product-page__external-video iframe {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .product-page__placeholder {
    width: 100%;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-bg-elevated);
    border-radius: 1rem;
    min-height: 400px;
  }

  /* Info Section */
  .product-page__info {
    position: relative;
  }

  .product-page__info--sticky {
    position: sticky;
    top: 2rem;
    align-self: start;
  }

  @media screen and (max-width: 989px) {
    .product-page__info--sticky {
      position: static;
      top: auto;
    }
  }

  .product-page__vendor {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.75rem;
    font-weight: 500;
  }

  .product-page__vendor-link {
    color: inherit;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .product-page__vendor-link:hover {
    color: var(--color-text-primary);
    text-decoration: underline;
  }

  .product-page__title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  @media screen and (min-width: 750px) {
    .product-page__title {
      font-size: 2.5rem;
    }
  }

  /* Reviews */
  .product-page__reviews {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
  }

  .product-page__rating {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .product-page__star {
    width: 18px;
    height: 18px;
    color: #fbbf24;
    flex-shrink: 0;
  }

  .product-page__star--filled {
    color: #fbbf24;
  }

  .product-page__reviews-count {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .product-page__reviews-link {
    font-size: 0.875rem;
    color: var(--color-text-primary);
    text-decoration: underline;
    transition: color 0.3s ease;
  }

  .product-page__reviews-link:hover {
    color: var(--color-accent-lime);
  }

  /* Price */
  .product-page__price-wrapper {
    display: flex;
    align-items: baseline;
    gap: 1rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
  }

  .product-page__price {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text-primary);
    font-family: 'Space Grotesk', sans-serif;
  }

  .product-page__compare-price {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    text-decoration: line-through;
  }

  .product-page__discount-badge {
    background-color: var(--color-accent-lime);
    color: var(--color-text-primary);
    font-size: 0.875rem;
    font-weight: 700;
    padding: 0.375rem 0.75rem;
    border-radius: 9999px;
  }

  /* Stock Message */
  .product-page__stock-message {
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    margin-bottom: 1.5rem;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .product-page__stock-message--in-stock {
    background-color: rgba(34, 197, 94, 0.1);
    color: #16a34a;
  }

  .product-page__stock-message--low-stock {
    background-color: rgba(251, 146, 60, 0.1);
    color: #ea580c;
  }

  .product-page__stock-message--out-of-stock {
    background-color: rgba(239, 68, 68, 0.1);
    color: #dc2626;
  }

  /* Trust Badges */
  .product-page__trust-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    margin: 2rem 0;
    padding: 1.5rem 0;
    border-top: 1px solid var(--color-border-soft);
    border-bottom: 1px solid var(--color-border-soft);
  }

  .product-page__trust-badge {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .product-page__trust-badge img {
    width: 2.5rem;
    height: 2.5rem;
    object-fit: contain;
    flex-shrink: 0;
  }

  /* Tax/Shipping Text */
  .product-page__tax-shipping-text {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    margin-top: 1rem;
    margin-bottom: 1.5rem;
  }

  /* Benefits */
  .product-page__benefits {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin: 2rem 0;
    padding: 1.5rem;
    background-color: var(--color-bg-section-soft);
    border-radius: 0.75rem;
  }

  .product-page__benefit-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    font-size: 0.875rem;
    color: var(--color-text-primary);
    line-height: 1.5;
  }

  .product-page__benefit-icon {
    flex-shrink: 0;
    width: 1.25rem;
    height: 1.25rem;
    color: var(--color-accent-lime);
    margin-top: 0.125rem;
  }

  /* Share Buttons */
  .product-page__share {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border-soft);
  }

  .product-page__share-label {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-primary);
  }

  .product-page__share-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 50%;
    background-color: var(--color-bg-elevated);
    color: var(--color-text-primary);
    text-decoration: none;
    transition: all 0.3s ease;
    border: 1px solid var(--color-border-soft);
  }

  .product-page__share-link:hover {
    background-color: var(--color-text-primary);
    color: var(--color-bg-elevated);
    transform: translateY(-2px);
    border-color: var(--color-text-primary);
  }

  /* Product Details Section */
  .product-page__details {
    margin-top: 5rem;
    padding-top: 4rem;
    border-top: 1px solid var(--color-border-soft);
  }

  .product-page__details-grid {
    display: grid;
    gap: 3rem;
  }

  @media screen and (min-width: 750px) {
    .product-page__details-grid {
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
    }
  }

  .product-page__details-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 1.5rem;
  }

  .product-page__description {
    color: var(--color-text-secondary);
    line-height: 1.8;
    font-size: 1rem;
  }

  .product-page__description h3,
  .product-page__description h4 {
    font-family: 'Space Grotesk', sans-serif;
    color: var(--color-text-primary);
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-size: 1.25rem;
  }

  .product-page__description ul,
  .product-page__description ol {
    padding-left: 1.5rem;
    margin: 1rem 0;
  }

  .product-page__description li {
    margin: 0.5rem 0;
  }

  .product-page__info-content {
    color: var(--color-text-secondary);
    line-height: 1.8;
    font-size: 1rem;
  }

  .product-page__info-content ul,
  .product-page__info-content ol {
    padding-left: 1.5rem;
    margin: 1rem 0;
  }

  .product-page__info-content li {
    margin: 0.5rem 0;
  }
</style>

{% schema %}
{
  "name": "Product",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Shipping Banner"
    },
    {
      "type": "checkbox",
      "id": "show_shipping_banner",
      "label": "Show shipping banner",
      "default": false
    },
    {
      "type": "text",
      "id": "shipping_banner_text",
      "label": "Shipping banner text",
      "default": "You're only $40.01 away from free shipping"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_info",
      "label": "Enable sticky product info",
      "default": true
    },
    {
      "type": "select",
      "id": "media_position",
      "label": "Media position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "gallery_layout",
      "label": "Gallery layout",
      "options": [
        {
          "value": "thumbnails-left",
          "label": "Thumbnails on left"
        },
        {
          "value": "thumbnails-bottom",
          "label": "Thumbnails below"
        }
      ],
      "default": "thumbnails-left",
      "info": "Choose thumbnail position: left side (vertical) or below main image (horizontal)"
    },
    {
      "type": "select",
      "id": "media_fit",
      "label": "Media fit",
      "options": [
        {
          "value": "contain",
          "label": "Contain"
        },
        {
          "value": "cover",
          "label": "Cover"
        }
      ],
      "default": "contain"
    },
    {
      "type": "select",
      "id": "image_zoom",
      "label": "Image zoom",
      "options": [
        {
          "value": "lightbox",
          "label": "Lightbox"
        },
        {
          "value": "none",
          "label": "None"
        }
      ],
      "default": "lightbox"
    },
    {
      "type": "select",
      "id": "mobile_thumbnails",
      "label": "Mobile thumbnails",
      "options": [
        {
          "value": "show",
          "label": "Show"
        },
        {
          "value": "hide",
          "label": "Hide"
        }
      ],
      "default": "show"
    },
    {
      "type": "header",
      "content": "Product Information"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_reviews",
      "label": "Show reviews",
      "default": true
    },
    {
      "type": "text",
      "id": "reviews_rating",
      "label": "Rating (1-5)",
      "default": "5",
      "info": "Enter a number between 1 and 5"
    },
    {
      "type": "text",
      "id": "reviews_count",
      "label": "Reviews count",
      "default": "17"
    },
    {
      "type": "url",
      "id": "reviews_link",
      "label": "Reviews link (optional)"
    },
    {
      "type": "checkbox",
      "id": "show_tax_shipping_text",
      "label": "Show tax and shipping text",
      "default": true
    },
    {
      "type": "text",
      "id": "tax_shipping_text",
      "label": "Tax and shipping text",
      "default": "Taxes and shipping calculated at checkout"
    },
    {
      "type": "checkbox",
      "id": "show_benefits",
      "label": "Show benefits",
      "default": true
    },
    {
      "type": "text",
      "id": "benefit_1",
      "label": "Benefit 1",
      "default": "Free shipping on orders over $50"
    },
    {
      "type": "text",
      "id": "benefit_2",
      "label": "Benefit 2",
      "default": "30-day money-back guarantee"
    },
    {
      "type": "text",
      "id": "benefit_3",
      "label": "Benefit 3",
      "default": "Secure checkout"
    },
    {
      "type": "text",
      "id": "benefit_4",
      "label": "Benefit 4"
    },
    {
      "type": "checkbox",
      "id": "show_stock_message",
      "label": "Show stock message",
      "default": true
    },
    {
      "type": "range",
      "id": "low_stock_threshold",
      "min": 1,
      "max": 20,
      "step": 1,
      "unit": "items",
      "label": "Low stock threshold",
      "default": 5,
      "info": "Show low stock message when inventory is below this number"
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show description",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_product_info",
      "label": "Show product info section",
      "default": false
    },
    {
      "type": "text",
      "id": "product_info_title",
      "label": "Product info title",
      "default": "Product Info"
    },
    {
      "type": "richtext",
      "id": "product_info_content",
      "label": "Product info content",
      "info": "Use for care instructions, specifications, or other product details"
    },
    {
      "type": "header",
      "content": "Trust Badges"
    },
    {
      "type": "checkbox",
      "id": "show_trust_badges",
      "label": "Show trust badges",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "trust_badge_1_icon",
      "label": "Trust badge 1 icon"
    },
    {
      "type": "text",
      "id": "trust_badge_1_text",
      "label": "Trust badge 1 text",
      "default": "Free Shipping"
    },
    {
      "type": "image_picker",
      "id": "trust_badge_2_icon",
      "label": "Trust badge 2 icon"
    },
    {
      "type": "text",
      "id": "trust_badge_2_text",
      "label": "Trust badge 2 text",
      "default": "30-Day Returns"
    },
    {
      "type": "image_picker",
      "id": "trust_badge_3_icon",
      "label": "Trust badge 3 icon"
    },
    {
      "type": "text",
      "id": "trust_badge_3_text",
      "label": "Trust badge 3 text",
      "default": "Secure Payment"
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "checkbox",
      "id": "enable_payment_button",
      "label": "Show dynamic checkout button",
      "default": true,
      "info": "Lets customers check out directly using a familiar payment method."
    },
    {
      "type": "checkbox",
      "id": "show_wishlist_button",
      "label": "Show wishlist button",
      "default": false
    },
    {
      "type": "header",
      "content": "Gift Message"
    },
    {
      "type": "checkbox",
      "id": "show_gift_message",
      "label": "Show gift message field",
      "default": false
    },
    {
      "type": "text",
      "id": "gift_message_label",
      "label": "Gift message label",
      "default": "Is this a gift? Add a note! (optional)"
    },
    {
      "type": "text",
      "id": "gift_message_placeholder",
      "label": "Gift message placeholder",
      "default": "Enter your gift message here..."
    },
    {
      "type": "header",
      "content": "Social Sharing"
    },
    {
      "type": "checkbox",
      "id": "show_share_buttons",
      "label": "Show share buttons",
      "default": false
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "checkbox",
      "id": "hide_variants",
      "label": "Hide variant media",
      "default": false,
      "info": "Hide media associated with unselected variants"
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "label": "Enable video looping",
      "default": false
    }
  ]
}
{% endschema %}
